<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rochas A√ßa√≠</title>

<style>
*{
box-sizing:border-box;
font-family:Arial, sans-serif;
margin:0;
padding:0;
}

body{
height:100vh;
background:linear-gradient(135deg,#5b1fa6,#8a2be2);
display:flex;
justify-content:center;
align-items:center;
color:#fff;
overflow:hidden;
}

/* ===== ENGRENAGEM FIXA DEFINITIVA ===== */
.config-wrapper{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
pointer-events:none;
z-index:9999;
}

.config-btn{
position:absolute;
top:20px;
right:20px;
background:none;
border:none;
font-size:26px;
cursor:pointer;
pointer-events:auto;
display:none;
color:#fff;
}

/* ===== CARDS ===== */
.card{
background:rgba(255,255,255,0.08);
backdrop-filter:blur(15px);
padding:35px;
border-radius:20px;
width:90%;
max-width:420px;
text-align:center;
display:none;
}

.card.active{
display:block;
}

h1,h2{
margin-bottom:15px;
}

input{
width:100%;
padding:14px;
border:none;
border-radius:12px;
margin:15px 0;
font-size:18px;
}

button{
width:100%;
padding:15px;
border:none;
border-radius:14px;
background:#ffd60a;
color:#000;
font-size:18px;
margin-top:12px;
font-weight:bold;
cursor:pointer;
}

.valor{
font-size:42px;
margin:15px 0;
font-weight:bold;
}

.timer{
margin-top:10px;
font-size:14px;
opacity:.9;
}

.codigo{
margin-top:8px;
font-size:13px;
opacity:.8;
}

.emoji-box{
display:flex;
justify-content:space-between;
margin-top:20px;
font-size:30px;
cursor:pointer;
}

/* ===== MODAL ===== */
.modal{
position:fixed;
inset:0;
background:rgba(0,0,0,.6);
display:none;
justify-content:center;
align-items:center;
}

.modal-box{
background:#2a024f;
padding:25px;
border-radius:20px;
width:90%;
max-width:350px;
text-align:center;
}

.modal-box input{
background:#fff;
color:#000;
margin-bottom:10px;
}
</style>
</head>

<body>

<!-- ENGRENAGEM FORA DO FLEX -->
<div class="config-wrapper">
<button class="config-btn" id="engrenagem" onclick="abrirSenha()">‚öô</button>
</div>

<!-- TELA 1 -->
<div class="card active" id="t1">
<h1 id="tituloLoja">Rochas A√ßa√≠ ‚Äì Unidade Ilha 9</h1>

<input 
id="telefone"
type="tel"
inputmode="numeric"
pattern="[0-9]*"
placeholder="Digite seu telefone"
/>

<button onclick="irPeso()">Continuar</button>
</div>

<!-- TELA 2 -->
<div class="card" id="t2">
<h2>Coloque o pote na balan√ßa</h2>
<div class="valor" id="peso">0 g</div>
<button onclick="simularPeso()">Simular peso</button>
<button onclick="irPagamento()">Continuar</button>
</div>

<!-- TELA 3 -->
<div class="card" id="t3">
<h2>Pague na maquininha ao lado</h2>
<div class="valor" id="valor"></div>
<div class="codigo" id="codigoVenda"></div>
<div class="timer" id="timer"></div>
<button onclick="confirmar()">J√° paguei</button>
</div>

<!-- TELA 4 -->
<div class="card" id="t4">
<h2>Avalie nosso atendimento</h2>
<div class="emoji-box">
<span onclick="avaliar('üò°')">üò°</span>
<span onclick="avaliar('üòï')">üòï</span>
<span onclick="avaliar('üòê')">üòê</span>
<span onclick="avaliar('üôÇ')">üôÇ</span>
<span onclick="avaliar('üòç')">üòç</span>
</div>
</div>

<!-- MODAL CONFIG -->
<div class="modal" id="modal">
<div class="modal-box">
<h3>Configura√ß√µes</h3>
<input id="confTitulo" placeholder="Novo t√≠tulo">
<input id="confKg" placeholder="Valor do KG (ex: 59.90)">
<button onclick="salvarConfig()">Salvar</button>
<button onclick="fecharModal()">Fechar</button>
</div>
</div>

<script>

let pesoAtual = 0;
let valorKg = parseFloat(localStorage.getItem("kg")) || 59.90;
let codigoAtual = "";
let timerInterval;

/* Carregar t√≠tulo salvo */
document.getElementById("tituloLoja").innerText =
localStorage.getItem("titulo") || "Rochas A√ßa√≠ ‚Äì Unidade Ilha 9";

/* Trocar tela */
function trocar(id){
document.querySelectorAll(".card").forEach(c=>c.classList.remove("active"));
document.getElementById(id).classList.add("active");

/* Mostrar engrenagem apenas na tela inicial */
if(id === "t1"){
document.getElementById("engrenagem").style.display = "block";
}else{
document.getElementById("engrenagem").style.display = "none";
}
}

/* Inicializa */
trocar("t1");

/* Telefone -> Peso */
function irPeso(){
let tel = document.getElementById("telefone").value;
if(tel.length < 8){
alert("Digite um telefone v√°lido");
return;
}
trocar("t2");
}

/* Simular peso */
function simularPeso(){
pesoAtual = Math.floor(Math.random()*500)+150;
document.getElementById("peso").innerText = pesoAtual + " g";
}

/* Peso -> Pagamento */
function irPagamento(){
if(pesoAtual===0){
alert("Simule o peso primeiro");
return;
}

let valor = (pesoAtual/1000 * valorKg).toFixed(2);
document.getElementById("valor").innerText = "R$ " + valor;

codigoAtual = "RA" + Date.now();
document.getElementById("codigoVenda").innerText =
"C√≥digo: " + codigoAtual;

trocar("t3");
iniciarTimer();
}

/* Timer */
function iniciarTimer(){
let tempo = 30;

document.getElementById("timer").innerText =
"Tempo restante: "+tempo+"s";

timerInterval = setInterval(()=>{
tempo--;
document.getElementById("timer").innerText =
"Tempo restante: "+tempo+"s";

if(tempo<=0){
clearInterval(timerInterval);
alert("Tempo expirado");
location.reload();
}
},1000);
}

/* Confirmar pagamento */
function confirmar(){
clearInterval(timerInterval);

let venda = {
codigo: codigoAtual,
telefone: document.getElementById("telefone").value,
peso: pesoAtual,
valor: (pesoAtual/1000 * valorKg).toFixed(2),
data: new Date().toLocaleString()
};

let vendas = JSON.parse(localStorage.getItem("vendas")||"[]");
vendas.push(venda);
localStorage.setItem("vendas",JSON.stringify(vendas));

trocar("t4");
}

/* Avalia√ß√£o */
function avaliar(emoji){
let vendas = JSON.parse(localStorage.getItem("vendas"));
vendas[vendas.length-1].avaliacao = emoji;
localStorage.setItem("vendas",JSON.stringify(vendas));

setTimeout(()=>{
location.reload();
},1500);
}

/* Config */
function abrirSenha(){
let senha = prompt("Digite a senha:");
if(senha==="1951"){
document.getElementById("modal").style.display="flex";
}
}

function salvarConfig(){
let novoTitulo=document.getElementById("confTitulo").value;
let novoKg=parseFloat(document.getElementById("confKg").value);

if(novoTitulo){
localStorage.setItem("titulo",novoTitulo);
document.getElementById("tituloLoja").innerText=novoTitulo;
}

if(!isNaN(novoKg)){
localStorage.setItem("kg",novoKg);
valorKg=novoKg;
}

alert("Salvo com sucesso!");
}

function fecharModal(){
document.getElementById("modal").style.display="none";
}

</script>

</body>
</html>
