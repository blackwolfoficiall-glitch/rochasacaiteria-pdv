<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rochas Açaí</title>

<style>
*{box-sizing:border-box;font-family:Arial,sans-serif}

body{
margin:0;
height:100vh;
background:linear-gradient(135deg,#5b1fa6,#8a2be2);
display:flex;
justify-content:center;
align-items:center;
color:#fff;
overflow:hidden;
}

/* ENGRENAGEM FIXA */
.config-btn{
position:fixed;
top:15px;
right:15px;
background:none;
border:none;
font-size:24px;
cursor:pointer;
z-index:9999;
}

/* CARD */
.card{
background:rgba(255,255,255,0.08);
backdrop-filter:blur(15px);
padding:30px;
border-radius:20px;
width:90%;
max-width:400px;
text-align:center;
display:none;
}

.card.active{display:block}

h1,h2{margin:10px 0}

input{
width:100%;
padding:14px;
border:none;
border-radius:12px;
margin:15px 0;
font-size:18px;
}

button{
width:100%;
padding:15px;
border:none;
border-radius:14px;
background:#ffd60a;
color:#000;
font-size:18px;
margin-top:12px;
font-weight:bold;
cursor:pointer;
}

.valor{
font-size:38px;
margin:15px 0;
font-weight:bold;
}

.timer{
margin-top:10px;
font-size:14px;
opacity:.9;
}

.pix-box img{
margin-top:15px;
width:200px;
height:200px;
background:#fff;
padding:10px;
border-radius:12px;
}
</style>
</head>

<body>

<button class="config-btn" onclick="abrirSenha()">⚙</button>

<!-- TELA 1 TELEFONE -->
<div class="card active" id="t1">
<h1 id="tituloLoja">Rochas Açaí – Unidade Ilha 9</h1>

<input 
id="telefone"
type="tel"
inputmode="numeric"
pattern="[0-9]*"
placeholder="Digite seu telefone"
/>

<button onclick="irPeso()">Continuar</button>
</div>

<!-- TELA 2 PESO -->
<div class="card" id="t2">
<h2>Coloque o pote na balança</h2>
<div class="valor" id="peso">0 g</div>
<button onclick="simularPeso()">Simular peso</button>
<button onclick="irPagamento()">Continuar</button>
</div>

<!-- TELA 3 ESCOLHA PAGAMENTO -->
<div class="card" id="t3">
<h2>Escolha a forma de pagamento</h2>
<div class="valor" id="valor"></div>
<button onclick="pagarPix()">Pagar com PIX</button>
<button onclick="pagarCartao()">Pagar com Cartão</button>
</div>

<!-- TELA PIX -->
<div class="card" id="tPix">
<h2>Escaneie o QR Code</h2>
<div class="valor" id="valorPix"></div>
<div class="pix-box">
<img id="qrCode">
</div>
<button onclick="confirmar()">Já paguei</button>
</div>

<!-- TELA CARTÃO -->
<div class="card" id="tCartao">
<h2>Pague na maquininha ao lado</h2>
<div class="valor" id="valorCartao"></div>
<div class="timer" id="timer"></div>
<button onclick="confirmar()">Pagamento confirmado</button>
</div>

<script>

let pesoAtual = 0;
let valorKg = localStorage.getItem("kg") || 59.90;
let codigoAtual = "";
let timerInterval;

/* Troca tela */
function trocar(id){
document.querySelectorAll(".card").forEach(c=>c.classList.remove("active"));
document.getElementById(id).classList.add("active");
}

/* Telefone -> Peso */
function irPeso(){
let tel = document.getElementById("telefone").value;
if(tel.length < 8){
alert("Digite um telefone válido");
return;
}
trocar("t2");
}

/* Simular peso */
function simularPeso(){
pesoAtual = Math.floor(Math.random()*500)+150;
document.getElementById("peso").innerText = pesoAtual + " g";
}

/* Peso -> Escolha */
function irPagamento(){
if(pesoAtual===0){
alert("Simule o peso primeiro");
return;
}

let valor = (pesoAtual/1000 * valorKg).toFixed(2);
document.getElementById("valor").innerText = "R$ " + valor;

codigoAtual = "RA" + Date.now();
trocar("t3");
}

/* PIX */
function pagarPix(){
let valor = (pesoAtual/1000 * valorKg).toFixed(2);

document.getElementById("valorPix").innerText = "R$ " + valor;

/* QR CODE PIX SIMPLES (simulado) */
let pixString = "Pagamento Rochas Açaí R$"+valor+" Código:"+codigoAtual;

document.getElementById("qrCode").src =
"https://api.qrserver.com/v1/create-qr-code/?size=200x200&data="
+ encodeURIComponent(pixString);

trocar("tPix");
}

/* CARTÃO */
function pagarCartao(){
let valor = (pesoAtual/1000 * valorKg).toFixed(2);
document.getElementById("valorCartao").innerText = "R$ " + valor;

trocar("tCartao");
iniciarTimer();
}

/* TIMER */
function iniciarTimer(){
let tempo = 30;
document.getElementById("timer").innerText =
"Tempo restante: "+tempo+"s";

timerInterval = setInterval(()=>{
tempo--;
document.getElementById("timer").innerText =
"Tempo restante: "+tempo+"s";

if(tempo<=0){
clearInterval(timerInterval);
alert("Tempo expirado.");
location.reload();
}
},1000);
}

/* Confirmar pagamento */
function confirmar(){

clearInterval(timerInterval);

let venda = {
codigo: codigoAtual,
telefone: document.getElementById("telefone").value,
peso: pesoAtual,
valor: (pesoAtual/1000 * valorKg).toFixed(2),
data: new Date().toLocaleString()
};

let vendas = JSON.parse(localStorage.getItem("vendas")||"[]");
vendas.push(venda);
localStorage.setItem("vendas",JSON.stringify(vendas));

alert("Pagamento registrado com sucesso!");
location.reload();
}

/* CONFIGURAÇÃO */
function abrirSenha(){
let senha = prompt("Digite a senha:");
if(senha==="1951"){
let novoTitulo = prompt("Novo título:");
if(novoTitulo){
localStorage.setItem("titulo",novoTitulo);
document.getElementById("tituloLoja").innerText = novoTitulo;
}
}
}

document.getElementById("tituloLoja").innerText =
localStorage.getItem("titulo") || "Rochas Açaí – Unidade Ilha 9";

</script>

</body>
</html>
